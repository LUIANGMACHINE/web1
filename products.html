<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>产品中心 - LUIANG MACHINE</title>
    <meta name="description" content="浏览LUIANG MACHINE的完整产品线，包括加油机、工业泵、流量计及相关配件">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- 社交链接侧边栏 -->
    <div class="social-sidebar">
        <a href="https://facebook.com" target="_blank" class="social-link">
            <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://instagram.com" target="_blank" class="social-link">
            <i class="fab fa-instagram"></i>
        </a>
        <a href="https://twitter.com" target="_blank" class="social-link">
            <i class="fab fa-twitter"></i>
        </a>
        <a href="https://linkedin.com" target="_blank" class="social-link">
            <i class="fab fa-linkedin-in"></i>
        </a>
        <a href="https://wa.me/8617712875791" target="_blank" class="social-link">
            <i class="fab fa-whatsapp"></i>
        </a>
    </div>

    <!-- Header将通过JS动态加载 -->
    
    <main>
        <section class="products-page">
            <div class="container">
                <div class="page-header">
                    <h1 data-lang="products">产品中心</h1>
                    <p data-lang="products-description">探索我们全面的工业设备解决方案</p>
                </div>

                <!-- 产品筛选 -->
                <div class="product-filters">
                    <div class="filter-group">
                        <label data-lang="filter-by-category">按分类筛选:</label>
                        <select id="category-filter">
                            <option value="all" data-lang="all-categories">所有分类</option>
                            <option value="fuel-dispenser" data-lang="fuel-dispenser">加油机</option>
                            <option value="dispenser-parts" data-lang="dispenser-parts">加油机配件</option>
                            <option value="adblue-equipment" data-lang="adblue-equipment">尿素配件</option>
                            <option value="pump-flowmeter" data-lang="pump-flowmeter">工业泵和流量计</option>
                            <option value="lpg-equipment" data-lang="lpg-equipment">LPG 配件</option>
                            <option value="other-equipment" data-lang="other-equipment">其他</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label data-lang="sort-by">排序方式:</label>
                        <select id="sort-filter">
                            <option value="newest" data-lang="newest">最新产品</option>
                            <option value="name" data-lang="name">产品名称</option>
                        </select>
                    </div>
                </div>

                <!-- 产品网格 -->
                <div class="products-grid" id="products-grid">
                    <!-- 产品将通过JS动态加载 -->
                </div>

                <!-- 加载更多 -->
                <div class="load-more">
                    <button id="load-more-btn" class="btn-primary" data-lang="load-more">加载更多</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer将通过JS动态加载 -->

    <script src="js/language-system.js"></script>
    <script src="js/components-loader.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/social-links.js"></script>
    <script>
        let currentPage = 1;
        const productsPerPage = 8;
        let allProducts = [];

        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupFilters();
        });

        function loadProducts() {
            const savedProducts = JSON.parse(localStorage.getItem('products')) || [];
            
            if (savedProducts.length === 0) {
                // 默认产品数据
                allProducts = [
                    {
                        id: '1',
                        name: '高端加油机',
                        description: '高性能加油机，适用于各种加油站，精确计量，耐用可靠',
                        price: '询价',
                        category: 'fuel-dispenser',
                        image: 'images/product1.jpg',
                        date: '2023-10-01'
                    },
                    {
                        id: '2',
                        name: '流量计配件',
                        description: '精密流量计配件，确保准确测量，延长设备寿命',
                        price: '询价',
                        category: 'pump-flowmeter',
                        image: 'images/product2.jpg',
                        date: '2023-10-02'
                    },
                    {
                        id: '3',
                        name: 'LPG设备',
                        description: '安全可靠的LPG设备解决方案，符合国际安全标准',
                        price: '询价',
                        category: 'lpg-equipment',
                        image: 'images/product3.jpg',
                        date: '2023-10-03'
                    },
                    {
                        id: '4',
                        name: '尿素泵',
                        description: '高效尿素输送泵，适用于各种柴油车辆',
                        price: '询价',
                        category: 'adblue-equipment',
                        image: 'images/product4.jpg',
                        date: '2023-10-04'
                    },
                    {
                        id: '5',
                        name: '加油枪',
                        description: '高品质加油枪，防滴漏设计，操作简便',
                        price: '询价',
                        category: 'dispenser-parts',
                        image: 'images/product5.jpg',
                        date: '2023-10-05'
                    },
                    {
                        id: '6',
                        name: '工业泵',
                        description: '重型工业泵，适用于各种流体输送场景',
                        price: '询价',
                        category: 'pump-flowmeter',
                        image: 'images/product6.jpg',
                        date: '2023-10-06'
                    },
                    {
                        id: '7',
                        name: 'LPG阀门',
                        description: '安全阀门系统，确保LPG设备安全运行',
                        price: '询价',
                        category: 'lpg-equipment',
                        image: 'images/product7.jpg',
                        date: '2023-10-07'
                    },
                    {
                        id: '8',
                        name: '流量显示器',
                        description: '数字流量显示器，实时监控流量数据',
                        price: '询价',
                        category: 'pump-flowmeter',
                        image: 'images/product8.jpg',
                        date: '2023-10-08'
                    },
                    {
                        id: '9',
                        name: '加油机主板',
                        description: '原装加油机控制主板，稳定可靠',
                        price: '询价',
                        category: 'dispenser-parts',
                        image: 'images/product9.jpg',
                        date: '2023-10-09'
                    },
                    {
                        id: '10',
                        name: '尿素喷嘴',
                        description: '精密尿素喷嘴，雾化效果好',
                        price: '询价',
                        category: 'adblue-equipment',
                        image: 'images/product10.jpg',
                        date: '2023-10-10'
                    }
                ];
            } else {
                allProducts = savedProducts;
            }

            displayProducts();
        }

        function setupFilters() {
            const categoryFilter = document.getElementById('category-filter');
            const sortFilter = document.getElementById('sort-filter');
            const loadMoreBtn = document.getElementById('load-more-btn');

            if (categoryFilter) {
                categoryFilter.addEventListener('change', function() {
                    currentPage = 1;
                    displayProducts();
                });
            }

            if (sortFilter) {
                sortFilter.addEventListener('change', function() {
                    currentPage = 1;
                    sortProducts();
                    displayProducts();
                });
            }

            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', function() {
                    currentPage++;
                    displayProducts(true);
                });
            }
        }

        function sortProducts() {
            const sortBy = document.getElementById('sort-filter').value;
            
            if (sortBy === 'name') {
                allProducts.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sortBy === 'newest') {
                allProducts.sort((a, b) => new Date(b.date) - new Date(a.date));
            }
        }

        function displayProducts(append = false) {
            const productsGrid = document.getElementById('products-grid');
            if (!productsGrid) return;

            const categoryFilter = document.getElementById('category-filter').value;
            let filteredProducts = allProducts;

            if (categoryFilter !== 'all') {
                filteredProducts = allProducts.filter(product => product.category === categoryFilter);
            }

            const startIndex = 0;
            const endIndex = currentPage * productsPerPage;
            const productsToShow = filteredProducts.slice(startIndex, endIndex);

            let html = '';
            productsToShow.forEach(product => {
                html += `
                    <div class="product-item" data-category="${product.category}">
                        <img src="${product.image || 'images/default-product.jpg'}" alt="${product.name}">
                        <div class="product-info">
                            <span class="product-category" data-lang="${product.category}">${getTranslation(product.category)}</span>
                            <h3>${product.name}</h3>
                            <p class="product-description">${product.description}</p>
                            <p class="product-price">${product.price}</p>
                            <div class="product-actions">
                                <button class="btn-primary add-to-cart" 
                                        data-product-id="${product.id}" 
                                        data-product-name="${product.name}">
                                    <span data-lang="add-to-cart">加入购物车</span>
                                </button>
                                <a href="product-details.html?id=${product.id}" class="btn-secondary" data-lang="view-details">查看详情</a>
                            </div>
                        </div>
                    </div>
                `;
            });

            if (append) {
                productsGrid.innerHTML += html;
            } else {
                productsGrid.innerHTML = html;
            }

            // 更新加载更多按钮状态
            const loadMoreBtn = document.getElementById('load-more-btn');
            if (loadMoreBtn) {
                if (endIndex >= filteredProducts.length) {
                    loadMoreBtn.style.display = 'none';
                } else {
                    loadMoreBtn.style.display = 'block';
                }
            }

            // 重新应用语言
            applyLanguage();
        }
    </script>
</body>
</html>